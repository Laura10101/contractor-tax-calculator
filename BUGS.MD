|   GH ID | Title                                                                                       | Description                                                                                                                                                                                                                                                                  | Resolution                                                                                                                                                                                                                                                                             | Github URL                                                         |
|--------:|:--------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------------|
|     105 | Testing secondary tiered rule with single tier fails AssertionError                         | FAILED rules_api/test_models.py::test_secondary_tiered_rule_iteration_with_single_tier_defined - assert 2800 == 3000.0                                                                                                                                                       | The test assumed that in this scenario the first unit of secondary income would be taxed within this tier. However, as the primary income fell below the tier minimum, this was not the case. Updated the test to reflect the fact that the first £1000 would be taxed below the tier. | https://github.com/Laura10101/contractor-tax-calculator/issues/105 |
|     104 | Testing secondary tiered rule with single tier fails with IntegrityError                    | FAILED rules_api/test_models.py::test_secondary_tiered_rule_iteration_with_single_tier_defined - django.db.utils.IntegrityError: NOT NULL constraint failed: rules_api_rule.ruleset_id                                                                                       | Equality operator used to assign the primary rule's ruleset to the secondary rule. This was replaced with the assignment operator.                                                                                                                                                     | https://github.com/Laura10101/contractor-tax-calculator/issues/104 |
|     103 | Testing ruleset iteration with multiple rules fails as only one result created              | FAILED rules_api/test_models.py::test_ruleset_iteration_with_multiple_rules_defined - assert 1 == 2                                                                                                                                                                          | The test was setting the salary to 9000 which was below the min_value for the tiered rate rule. The tiered rate rule was therefore not being applied. Increased the salary to 30000                                                                                                    | https://github.com/Laura10101/contractor-tax-calculator/issues/103 |
|     102 | Testing ruleset iteration with no rules fails as test result created                        | FAILED rules_api/test_models.py::test_ruleset_iteration_with_no_rules_defined - AssertionError: assert 1 == 0                                                                                                                                                                | Added check to ensure rules exist within the ruleset before creating the RuleSet result                                                                                                                                                                                                | https://github.com/Laura10101/contractor-tax-calculator/issues/102 |
|     101 | Iterating over tiered rate rule with multiple tiers fails due with AssertionError           | FAILED rules_api/test_models.py::test_tiered_rule_iteration_with_multiple_tiers_defined - assert 13499.550000000001 == 13499.55                                                                                                                                              | Added rounding to the calculate method for RuleTiers to round to 2 dp.                                                                                                                                                                                                                 | https://github.com/Laura10101/contractor-tax-calculator/issues/101 |
|     100 | Iterating over tiered rate rule with multiple tiers fails due to DecimalField conversion    | FAILED rules_api/test_models.py::test_tiered_rule_iteration_with_multiple_tiers_defined - AssertionError: assert Decimal('13499.55') == 13499.55                                                                                                                             | TaxPayable and Tier Tax Rates are stored as a decimal value but floats are used outside of the Django models. Updated model to store tax_payable and variable_value and tier_rate as FloatField.                                                                                       | https://github.com/Laura10101/contractor-tax-calculator/issues/100 |
|      99 | Secondary tiered rate rule applies tiers where no secondary income                          | FAILED rules_api/test_models.py::test_secondary_tier_calculate_where_primary_income_on_lower_boundary_and_no_secondary_income - AssertionError: assert 1 == 0                                                                                                                | Updated SecondaryTieredRateRule to ignore tiers if no secondary income                                                                                                                                                                                                                 | https://github.com/Laura10101/contractor-tax-calculator/issues/99  |
|      98 | Secondary rule tier calculate method not passing variable_value to add_result() method      | FAILED rules_api/test_models.py::test_secondary_tier_calculate_where_total_income_below_lower_boundary - TypeError: TaxRuleSetResult.add_result() missing 1 required positional argument: 'variable_value'                                                                   | Updated SecondaryRuleTier to pass secondary income as variable value                                                                                                                                                                                                                   | https://github.com/Laura10101/contractor-tax-calculator/issues/98  |
|      97 | Secondary rule tier tests failing with NameError                                            | FAILED rules_api/test_models.py::test_secondary_tier_calculate_where_total_income_below_lower_boundary - NameError: name 'lower_limit' is not defined                                                                                                                        | Updated reference to 'lower_limit' to use correct variable name ('tier_min')                                                                                                                                                                                                           | https://github.com/Laura10101/contractor-tax-calculator/issues/97  |
|      96 | Secondary rule was passing only the secondary income to the secondary tier calculate method | FAILED rules_api/test_models.py::test_secondary_tier_calculate_where_total_income_below_lower_boundary - TypeError: SecondaryRuleTier.calculate() missing 1 required positional argument: 'ruleset_results'                                                                  | Updated the secondarytieredraterule calculate function to pass in both variables                                                                                                                                                                                                       | https://github.com/Laura10101/contractor-tax-calculator/issues/96  |
|      95 | No variable name found when calculating SecondaryTier result                                | FAILED rules_api/test_models.py::test_secondary_tier_calculate_where_total_income_below_lower_boundary - KeyError: ''                                                                                                                                                        | Helper function was not setting the variable_name on the secondary rule                                                                                                                                                                                                                | https://github.com/Laura10101/contractor-tax-calculator/issues/95  |
|      94 | Secondary rule tier tests failing to sort tiers by ordinal                                  | FAILED rules_api/test_models.py::test_secondary_tier_calculate_where_total_income_below_lower_boundary - django.core.exceptions.FieldError: Cannot resolve keyword 'ordinal' into field. Choices are: id, primary_tier, primary_tier_id, secondary_rule, secondary_rule_i... | SecondaryRuleTier has no ordinal so updated to order by the related primary tier ordinal                                                                                                                                                                                               | https://github.com/Laura10101/contractor-tax-calculator/issues/94  |
|      93 | Secondary rule tier tests creating duplicate jurisdictions                                  | FAILED rules_api/test_models.py::test_secondary_tier_calculate_where_total_income_below_lower_boundary - django.db.utils.IntegrityError: UNIQUE constraint failed: jurisdictions_api_jurisdiction.name                                                                       | Added a count to the end of jurisdiction name to disambiguate                                                                                                                                                                                                                          | https://github.com/Laura10101/contractor-tax-calculator/issues/93  |
|      92 | Secondary rule tier tests fail with IntegrityError                                          | FAILED rules_api/test_models.py::test_secondary_tier_calculate_where_total_income_below_lower_boundary - django.db.utils.IntegrityError: NOT NULL constraint failed: rules_api_rule.ordinal                                                                                  | The create_mock_secondary_Tiered_Rate_Rule helper function was not setting mandatory fields on the new rule                                                                                                                                                                            | https://github.com/Laura10101/contractor-tax-calculator/issues/92  |
|      91 | Rule tier tests fail when variable < min_value                                              | FAILED rules_api/test_models.py::test_rule_tier_calculate_where_income_below_boundary - AssertionError: assert 1 == 0                                                                                                                                                        | The RuleTier was not checking to ensure the variable was above the min_value before applying itself                                                                                                                                                                                    | https://github.com/Laura10101/contractor-tax-calculator/issues/91  |
|      90 | Rule tier tests fail with TypeError                                                         | TypeError: TaxRuleSetResult.add_result() missing 1 required positional argument: 'variable_value'                                                                                                                                                                            | Updated the RuleTier to pass the variable_value to add_result                                                                                                                                                                                                                          | https://github.com/Laura10101/contractor-tax-calculator/issues/90  |
|      89 | Rule tier tests fail with TypeError                                                         | FAILED rules_api/test_models.py::test_rule_tier_calculate_where_income_below_boundary - TypeError: '<' not supported between instances of 'dict' and 'int'                                                                                                                   | The TieredRateRule was passing the variable table rather than the variable to the tier                                                                                                                                                                                                 | https://github.com/Laura10101/contractor-tax-calculator/issues/89  |
|      88 | Rule tier tests fail with RelatedObjectDoesNotExist                                         | FAILED rules_api/test_models.py::test_rule_tier_calculate_where_income_below_boundary - rules_api.models.RuleTier.rule.RelatedObjectDoesNotExist: RuleTier has no rule.                                                                                                      |                                                                                                                                                                                                                                                                                        | https://github.com/Laura10101/contractor-tax-calculator/issues/88  |
|         |                                                                                             | FAILED rules_api/test_models.py::test_rule_tier_calculate_where_income_on_lower_boundary - rules_api.models.RuleTier.rule.RelatedObjectDoesNotExist: RuleTier has no rule.                                                                                                   |                                                                                                                                                                                                                                                                                        |                                                                    |
|         |                                                                                             | FAILED rules_api/test_models.py::test_rule_tier_calculate_where_income_within_boundaries - rules_api.models.RuleTier.rule.RelatedObjectDoesNotExist: RuleTier has no rule.                                                                                                   |                                                                                                                                                                                                                                                                                        |                                                                    |
|         |                                                                                             | FAILED rules_api/test_models.py::test_rule_tier_calculate_where_income_on_upper_boundary - rules_api.models.RuleTier.rule.RelatedObjectDoesNotExist: RuleTier has no rule.                                                                                                   |                                                                                                                                                                                                                                                                                        |                                                                    |
|         |                                                                                             | FAILED rules_api/test_models.py::test_rule_tier_calculate_where_income_above_upper_boundary - rules_api.models.RuleTier.rule.RelatedObjectDoesNotExist: RuleTier has no rule.                                                                                                |                                                                                                                                                                                                                                                                                        |                                                                    |
|         |                                                                                             | FAILED rules_api/test_models.py::test_rule_tier_calculate_where_no_upper_boundary_and_income_above_lower_boundary - rules_api.models.RuleTier.rule.RelatedObjectDoesNotExist: RuleTier has no rule.                                                                          |                                                                                                                                                                                                                                                                                        |                                                                    |
|      87 | Flat rate rule test fails with TypeError                                                    | FAILED rules_api/test_models.py::test_flat_rate_calculate - TypeError: object of type 'TaxRuleSetResult' has no len()                                                                                                                                                        | The test needed to be updated to reflect the new models for storing tax results as opposed to the old dictionary.                                                                                                                                                                      | https://github.com/Laura10101/contractor-tax-calculator/issues/87  |
|      86 | Flat rate rule test fails with IntegrityError                                               | FAILED rules_api/test_models.py::test_flat_rate_calculate - django.db.utils.IntegrityError: NOT NULL constraint failed: rules_api_taxruletierresult.tax_rate                                                                                                                 | The TaxRuleSetResult was not setting the tax_rate when creating the TaxRuleTierResult                                                                                                                                                                                                  | https://github.com/Laura10101/contractor-tax-calculator/issues/86  |
|      85 | Testing flat rate calculation fails with RelatedObjectDoesNotExist                          | FAILED rules_api/test_models.py::test_flat_rate_calculate - rules_api.models.Rule.ruleset.RelatedObjectDoesNotExist: Rule has no ruleset.. Did you mean: 'rule_ptr'?                                                                                                         | Updated test to create a fully instantiated ruleset and link this to the rule                                                                                                                                                                                                          | https://github.com/Laura10101/contractor-tax-calculator/issues/85  |
|      84 | Rule model tests failing with AttributeError                                                | FAILED rules_api/test_models.py::test_flat_rate_calculate - AttributeError: 'NoneType' object has no attribute 'add_result'                                                                                                                                                  | The helper function to create mock Ruleset results was not returning the created result object                                                                                                                                                                                         | https://github.com/Laura10101/contractor-tax-calculator/issues/84  |
|         |                                                                                             | FAILED rules_api/test_models.py::test_rule_tier_calculate_where_income_below_boundary - AttributeError: 'NoneType' object has no attribute 'add_result'                                                                                                                      |                                                                                                                                                                                                                                                                                        |                                                                    |
|         |                                                                                             | FAILED rules_api/test_models.py::test_rule_tier_calculate_where_income_on_lower_boundary - AttributeError: 'NoneType' object has no attribute 'add_result'                                                                                                                   |                                                                                                                                                                                                                                                                                        |                                                                    |
|         |                                                                                             | FAILED rules_api/test_models.py::test_rule_tier_calculate_where_income_within_boundaries - AttributeError: 'NoneType' object has no attribute 'add_result'                                                                                                                   |                                                                                                                                                                                                                                                                                        |                                                                    |
|         |                                                                                             | FAILED rules_api/test_models.py::test_rule_tier_calculate_where_income_on_upper_boundary - AttributeError: 'NoneType' object has no attribute 'add_result'                                                                                                                   |                                                                                                                                                                                                                                                                                        |                                                                    |
|         |                                                                                             | FAILED rules_api/test_models.py::test_rule_tier_calculate_where_income_above_upper_boundary - AttributeError: 'NoneType' object has no attribute 'add_result'                                                                                                                |                                                                                                                                                                                                                                                                                        |                                                                    |
|         |                                                                                             | FAILED rules_api/test_models.py::test_rule_tier_calculate_where_no_upper_boundary_and_income_above_lower_boundary - AttributeError: 'NoneType' object has no attribute 'add_result'                                                                                          |                                                                                                                                                                                                                                                                                        |                                                                    |
|         |                                                                                             | FAILED rules_api/test_models.py::test_secondary_tier_calculate_where_primary_income_on_lower_boundary_and_total_within_boundaries - AttributeError: 'NoneType' object has no attribute 'add_result'                                                                          |                                                                                                                                                                                                                                                                                        |                                                                    |
|         |                                                                                             | FAILED rules_api/test_models.py::test_secondary_tier_calculate_where_primary_income_and_total_within_boundaries - AttributeError: 'NoneType' object has no attribute 'add_result'                                                                                            |                                                                                                                                                                                                                                                                                        |                                                                    |
|         |                                                                                             | FAILED rules_api/test_models.py::test_secondary_tier_calculate_where_primary_income_within_boundaries_and_total_exceeds - AttributeError: 'NoneType' object has no attribute 'add_result'                                                                                    |                                                                                                                                                                                                                                                                                        |                                                                    |
|         |                                                                                             | FAILED rules_api/test_models.py::test_secondary_tier_calculate_where_primary_income_on_upper_boundary_and_total_exceeds - AttributeError: 'NoneType' object has no attribute 'add_result'                                                                                    |                                                                                                                                                                                                                                                                                        |                                                                    |
|         |                                                                                             | FAILED rules_api/test_models.py::test_secondary_tier_calculate_where_primary_income_above_upper_boundary - AttributeError: 'NoneType' object has no attribute 'add_result'                                                                                                   |                                                                                                                                                                                                                                                                                        |                                                                    |
|      83 | Rule model tests failing with TypeError 'int' is not subscriptable                          | FAILED rules_api/test_models.py::test_flat_rate_calculate - TypeError: 'int' object is not subscriptable                                                                                                                                                                     | Test is passing an int variable instead of a variable dictionary. Updated the test to correct this.                                                                                                                                                                                    | https://github.com/Laura10101/contractor-tax-calculator/issues/83  |
|      82 | Payment confirmation and completion is happening synchronously rather than via the webhook  | When confirming a payment via the Stripe API, the payment completes synchronously rather than asynchronously with a webhook posted back to the payment API.                                                                                                                  |                                                                                                                                                                                                                                                                                        | https://github.com/Laura10101/contractor-tax-calculator/issues/82  |
|      81 | Valid process payment tests failing with Payment.DoesNotExist                               | FAILED payments_api/test_services.py::test_process_payment_success - payments_api.models.Payment.DoesNotExist                                                                                                                                                                |                                                                                                                                                                                                                                                                                        | https://github.com/Laura10101/contractor-tax-calculator/issues/81  |
|         |                                                                                             | FAILED payments_api/test_services.py::test_process_payment_failure - payments_api.models.Payment.DoesNotExist                                                                                                                                                                |                                                                                                                                                                                                                                                                                        |                                                                    |
|      80 | Processing payment with unknown stripe pid fails to raise expected error                    | FAILED payments_api/test_services.py::test_process_payment_success_with_unknown_stripe_pid - Failed: DID NOT RAISE <class 'django.core.exceptions.ObjectDoesNotExist'>                                                                                                       | Updated the tests to expect Payment.DoesNotExist, and updated code to check the number of payments matching the PID.                                                                                                                                                                   | https://github.com/Laura10101/contractor-tax-calculator/issues/80  |
|         |                                                                                             | FAILED payments_api/test_services.py::test_process_payment_failure_with_unknown_stripe_pid - Failed: DID NOT RAISE <class 'django.core.exceptions.ObjectDoesNotExist'>                                                                                                       |                                                                                                                                                                                                                                                                                        |                                                                    |
|      79 | Process payment tests failing with FieldDoesNotExist error                                  | FAILED payments_api/test_services.py::test_process_payment_success - django.core.exceptions.FieldDoesNotExist: Payment has no field named 'created_or_failed_date'                                                                                                           | Was attempting to access 'created_or_failed_date' in services. Updated to access 'completed_or_failed_date'                                                                                                                                                                            | https://github.com/Laura10101/contractor-tax-calculator/issues/79  |
|         |                                                                                             | FAILED payments_api/test_services.py::test_process_payment_success_with_unknown_stripe_pid - django.core.exceptions.FieldDoesNotExist: Payment has no field named 'created_or_failed_date'                                                                                   |                                                                                                                                                                                                                                                                                        |                                                                    |
|         |                                                                                             | FAILED payments_api/test_services.py::test_process_payment_failure - django.core.exceptions.FieldDoesNotExist: Payment has no field named 'created_or_failed_date'                                                                                                           |                                                                                                                                                                                                                                                                                        |                                                                    |
|         |                                                                                             | FAILED payments_api/test_services.py::test_process_payment_failure_with_unknown_stripe_pid - django.core.exceptions.FieldDoesNotExist: Payment has no field named 'created_or_failed_date'                                                                                   |                                                                                                                                                                                                                                                                                        |                                                                    |
|      78 | Process payment tests failing with TypeError                                                | FAILED payments_api/test_services.py::test_process_payment_success - TypeError: Field 'id' expected a number but got (1, 'pi_3OMETKFkVBiDxSnk1zlGaQoh_secret_O8UJhoD0S96IDBSUFRTq6WH4Z').                                                                                    | create_payment service returns two parameters, but only one was being collected.                                                                                                                                                                                                       | https://github.com/Laura10101/contractor-tax-calculator/issues/78  |
|         |                                                                                             | FAILED payments_api/test_services.py::test_process_payment_failure - TypeError: Field 'id' expected a number but got (1, 'pi_3OMETLFkVBiDxSnk1rejsgjD_secret_CWy4lbdYkrDq613loEjBYE9sS').                                                                                    |                                                                                                                                                                                                                                                                                        |                                                                    |
|      77 | Process payment tests failing with NameError: 'APIClient'                                   | FAILED payments_api/test_services.py::test_process_payment_success - NameError: name 'APIClient' is not defined                                                                                                                                                              | Imported APIClient from rest_framework.test                                                                                                                                                                                                                                            | https://github.com/Laura10101/contractor-tax-calculator/issues/77  |
|      76 | Creation service test fails when passing a null subscription_id                             | FAILED payments_api/test_services.py::test_create_payment_with_null_subscription_id - Failed: DID NOT RAISE <class 'django.core.exceptions.ValidationError'>                                                                                                                 | Updated test to expect this to succeed as model explicitly allows subscription to be null. This is because a subscription may not exist for the user until after payment has completed if this is a new customer.                                                                      | https://github.com/Laura10101/contractor-tax-calculator/issues/76  |